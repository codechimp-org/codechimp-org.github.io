<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Versioning multi APK projects with Jenkins | CodeChimp</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Versioning multi APK projects with Jenkins" />
<meta name="author" content="Andrew Jackson" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I have used build numbers to version APK’s for a while but with the advent of Android Wear 2 multi APK publishing has forced me to think of a creative solution to continue to use build numbers." />
<meta property="og:description" content="I have used build numbers to version APK’s for a while but with the advent of Android Wear 2 multi APK publishing has forced me to think of a creative solution to continue to use build numbers." />
<link rel="canonical" href="http://localhost:4000/versioning-multi-apk-projects-with-jenkins/" />
<meta property="og:url" content="http://localhost:4000/versioning-multi-apk-projects-with-jenkins/" />
<meta property="og:site_name" content="CodeChimp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-24T14:28:36+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Versioning multi APK projects with Jenkins" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Andrew Jackson"},"dateModified":"2017-05-24T14:28:36+01:00","datePublished":"2017-05-24T14:28:36+01:00","description":"I have used build numbers to version APK’s for a while but with the advent of Android Wear 2 multi APK publishing has forced me to think of a creative solution to continue to use build numbers.","headline":"Versioning multi APK projects with Jenkins","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/versioning-multi-apk-projects-with-jenkins/"},"url":"http://localhost:4000/versioning-multi-apk-projects-with-jenkins/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="favicon.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="CodeChimp" /><script src="https://kit.fontawesome.com/ea8bca3c5d.js" crossorigin="anonymous"></script>
</head><body><header class="site-header" role="banner">
    
    <div class="wrapper"><a class="site-title" rel="author" href="/">CodeChimp</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
                    </svg>
                </span>
            </label>
            
            <div class="trigger">
                <a class="page-link" href=/blog>Blog</a>
                <a class="page-link" href=/privacy>Privacy Policy</a>
            </div>
        </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">Versioning multi APK projects with Jenkins</h1>
        <p class="post-meta">
            <div class="post-dt" style="width:60%; float:left" align-items: center;>
                <i class="fa-solid fa-calendar"></i>
                &nbsp;
                <time class="dt-published" datetime="2017-05-24T14:28:36+01:00" itemprop="datePublished">May 24, 2017
                </time></div>
            
            
            <div class="post-categories" style="width:40%; float:right">
                <div class="post-categories-list" style="display: flex; justify-content: flex-end; align-items: center;">
                    <i class="fa-solid fa-tags"></i>
                    &nbsp;
                    
                    
                    <a href="/categories/#android">android</a>
                    
                    
                </div>
            </div>
            
        </p>
        
        
    </header>
    
    <div class="post-content e-content" itemprop="articleBody">
        <p>I have used build numbers to version APK’s for a while but with the advent of Android Wear 2 multi APK publishing has forced me to think of a creative solution to continue to use build numbers.</p>

<p>The example here is specifically for Android Wear but the principals could easily be adopted for other multi APK needs such as resource or min-sdk specific versions.  Likewise most CI platforms will expose build numbers in a similar way to Jenkins so a similar method could be used regardless of your CI platform.</p>

<p>The problem with multi APK publishing is that each version code must be higher than anything previous.</p>

<p>To solve this I decided to multiply my build numbers by 10 and then add a specific digit for the variant.  In the case of Android Wear 2 this is in both the Wear and Mobile app modules, for resource or min-sdk specific versions this would be in the Flavours section of your app build.gradle.
So for example say I have Mobile and Wear apps, that’s 2 different versions I need.
If my build number is 27, for the mobile app I multiply by 10 and then add 1 to give me a version code of 271, for the Wear app I add 2 giving me a version code of 272.  For build 28 I get 281 and 282.</p>

<p>This way I get nice blocks of version codes to easily group releases together and I get 9 potential variants (10 if I went for a 0 based increment)</p>

<p>For release tagging in Git I suffix a 0 onto the end of the build number for the tag version and title so it matches the range I’ve published.</p>

<p>I also suffix the version code onto the version name to give a complete version number, and change the archive name to have the version name suffixed as well.</p>

<p>Finally, I like to maintain manual versions for local ad-hoc builds so I check if the Jenkins environment variable is present and fallback to my project level version codes if not.</p>

<p>The Gist below shows the relevant sections of build.gradle files for a typical mobile and wear app along with my static manual version codes in gradle properties and the string mashing I do within Jenkins git publisher.</p>

<script src="https://gist.github.com/e05e0f508796e3e863e1fa6a1867a9b0.js"> </script>


    </div><a class="u-url" href="/versioning-multi-apk-projects-with-jenkins/" hidden></a>
</article>

<script>
  document
    .querySelector('.post-content')
    .querySelectorAll('pre.highlight')
    .forEach(function (pre) {
      var button = document.createElement('button');
      var copyText = 'Copy';
      button.className = 'copy';
      button.type = 'button';
      button.ariaLabel = 'Copy code to clipboard';
      button.innerText = copyText;
      button.addEventListener('click', function () {
        var code = pre.querySelector('code').innerText.trim();
        navigator.clipboard.writeText(code);
        button.innerText = 'Copied';
        setTimeout(function () {
          button.innerText = copyText;
        }, 4000);
      });
      pre.appendChild(button);
    });
</script>

      </div>
    </main><footer class="site-footer h-card">
    <data class="u-url" href="/"></data>
    
    <div class="wrapper">
        
        <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/andrew-codechimp"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">andrew-codechimp</span></a></li></ul>
<ul class="social-media-list"><li><a rel="me" href="https://mastodon.online/@codechimp"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#mastodon"></use></svg> <span class="username">codechimp</span></a></li></ul>
        </div>
        
        <div class="copyright">
            Copyright © 2025 CodeChimp
        </div>
    </div>
    
</footer>
</body>

</html>
